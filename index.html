<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate"/>
<meta http-equiv="Pragma" content="no-cache"/>
<meta http-equiv="Expires" content="0"/>
<meta name="theme-color" content="#2563eb"/>
<title>JasperGYM</title>

<style>
:root{
  --bg:#91C6FF; --panel:#fff; --ink:#0f172a; --muted:#64748b;
  --brand:#2563eb; --ok:#16a34a; --warn:#f59e0b; --danger:#ef4444;
  --border:#d1d5db; --field:#fff;
}

*{ box-sizing:border-box }
html,body{ height:100% }
body{
  margin:0; background:var(--bg); color:var(--ink);
  font:14px/1.6 -apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"PingFang SC","Noto Sans CJK SC","Helvetica Neue",Arial;
}

/* å®¹å™¨ */
.wrap{ max-width:1100px; margin:0 auto; padding:16px 16px 140px }

/* é¡¶éƒ¨æ¡ */
.header{ background:transparent }
.headerbar{
  display:grid; grid-template-columns:1fr; gap:12px;
  background:transparent;
}

/* æ ‡é¢˜ + äº‘ç«¯/å¯¼èˆªæŒ‰é’®ä¸¤ç»„ï¼ˆä¸¤æ’éƒ½ç»Ÿä¸€ä¸º 4 åˆ—ç½‘æ ¼ï¼‰ */
.leftgrp, #tabs{
  display:grid !important;
  grid-template-columns: repeat(4, 1fr) !important;
  column-gap:8px !important; row-gap:8px !important;
  width:100% !important;
  justify-items:stretch !important; align-items:stretch !important;
}

.appTitle{ font-weight:800; font-size:18px; }

/* é¡¶éƒ¨æŒ‰é’®åŸºç¡€æ ·å¼ï¼ˆä¸¤æ’ç»Ÿä¸€ï¼‰ */
.gbtn{
  appearance:none; background:#fff; color:#111;
  border:1px solid var(--border);
  border-radius:12px;
  padding:0 16px; height:40px; line-height:40px;
  display:inline-flex; align-items:center; justify-content:center; gap:6px;
  font-weight:700; cursor:pointer; user-select:none; white-space:nowrap;
}
.gbtn:hover{ background:#f8fafc }
.gbtn:active{ transform:translateY(1px) }
.gbtn[disabled]{ opacity:.55; cursor:not-allowed }

/* â€”â€” ä½ çš„ 6 æ¡ CSS æŒ‡ä»¤ï¼šä¸¥æ ¼æŒ‰è¦æ±‚æ›¿æ¢ â€”â€” */

/* 1) é¦–é¡µâ€œè¿›å…¥è®­ç»ƒé¡µâ€æŒ‰é’®å¯¹é½ä¿®æ­£ */
#page-home .row.auto.vm-notes{
  display:grid;
  grid-template-columns: 1fr 140px; /* â† ä» 1fr auto æ”¹ä¸º 1fr 140px */
  gap:12px; align-items:center;
}

/* 2) è®¾ç½®é¡µè§†é¢‘ç®¡ç†åŒºåŸŸå¯¹é½ */
#vmRowTop, #vmRowNotes{
  display:grid;
  grid-template-columns: 1fr 1fr 1fr 140px; /* â† ä» ... auto æ”¹ä¸º 140px */
  gap:12px; align-items:end;
}

/* 3) å€’è®¡æ—¶è®¾ç½®åŒºåŸŸ */
#timerRow, #brandRow{
  display:grid;
  grid-template-columns: 1fr 1fr 140px; /* â† ä» ... auto æ”¹ä¸º 140px */
  gap:12px; align-items:end;
}

/* 4) ç»Ÿä¸€è®¾ç½®é¡µè¡Œå†…å‚ç›´å±…ä¸­ */
#page-settings .row.auto { align-items: center; } /* â† ä» end æ”¹ä¸º center */

/* 5) ç§»åŠ¨ç«¯é€‚é…ï¼ˆæŒ‰ä½ çš„ç‰ˆæœ¬ä¿æŒåˆ—=1 & æ‹‰ä¼¸å¯¹é½ï¼‰ */
@media (max-width: 900px) {
  #page-home .row.auto.vm-notes,
  #vmRowTop, #vmRowNotes,
  #timerRow, #brandRow {
    grid-template-columns: 1fr;
    align-items: stretch;
  }
  #page-settings .card:last-child .row.auto .btn { min-width: 100%; }
  #vmRowNotes .field.notes { grid-column: 1; }
}

/* 6) ç»Ÿä¸€æ“ä½œæŒ‰é’®å†…è¾¹è·/é«˜åº¦ */
#page-settings .row.auto .btn,
#page-settings .row.auto .gbtn,
#refVideoRow #openVideo.gbtn{
  padding:0 16px !important;
  height:40px !important;
  line-height:40px !important;
}

/* â€”â€” æœ¬æ¬¡æ–°å¢ï¼šå¼ºåˆ¶éšè—ä¸¤ä¸ªâ€œé“¾æ¥äº‘ç«¯â€æŒ‰é’®ï¼ˆåŒä¿é™©ï¼‰ â€”â€” */
.hide-btn{ display:none !important }
/* ç›´æ¥æŒ‰ ID åˆ‡æ–­æ˜¾ç¤ºï¼ˆé˜²æ­¢çº§è”è¦†ç›–ï¼‰ */
#btnVerify, #btnPing{ display:none !important }

/* å…¶ä»–é€šç”¨ */
.card{
  background:var(--panel); border:1px solid var(--border);
  border-radius:16px; padding:16px;
}
.row.auto{ display:grid; gap:12px; align-items:center }
.field{
  display:flex; align-items:center; gap:8px;
  background:var(--field); border:1px solid var(--border);
  border-radius:12px; padding:8px 12px; min-height:40px;
}
input[type="text"], input[type="number"], select, textarea{
  width:100%; border:0; outline:none; background:transparent;
  font:inherit; color:inherit;
}
.tiny{ font-size:12px; color:var(--muted) }
.hide{ display:none !important }

/* é¦–é¡µç¤ºæ„ */
.choices{ display:grid; grid-template-columns:repeat(auto-fit, minmax(140px,1fr)); gap:12px }
.choice{
  display:flex; align-items:center; gap:8px;
  background:#fff; border:1px solid var(--border); border-radius:12px;
  padding:12px; cursor:pointer;
}
.choice .name{ font-weight:700 }

/* é¡¶éƒ¨çŠ¶æ€ï¼ˆç‚¹ä½/æ–‡æ¡ˆå¯éšè—ï¼›æœ¬æ¬¡é»˜è®¤éšè—æ‰ï¼‰ */
#cloudDot, #cloudText, .appTitle { display:none !important; }

</style>
</head>
<body>

<div class="wrap">
  <div class="header">
    <div class="headerbar">

      <!-- å·¦ï¼šäº‘ç«¯æŒ‰é’®ï¼ˆç¬¬ä¸€æ’ï¼‰ â€”â€”â€”â€” åªä¿ç•™ 4 ä¸ª -->
      <div class="leftgrp">
        <!-- è¢«éšè—ï¼ˆID å¼ºåˆ¶ + class åŒä¿é™©ï¼‰ -->
        <button class="gbtn hide-btn" id="btnVerify">éªŒè¯äº‘ç«¯</button>
        <button class="gbtn hide-btn" id="btnPing">äº‘ç«¯è¿æ¥</button>

        <!-- ç¬¬ä¸€æ’ä¿ç•™çš„ 4 ä¸ªæŒ‰é’®ï¼ˆä¸ç¬¬äºŒæ’ä¸€è‡´å°ºå¯¸ï¼‰ -->
        <button class="gbtn navbtn" id="btnLoad"  disabled>äº‘ç«¯è¯»å–</button>
        <button class="gbtn navbtn" id="btnSave"  disabled>äº‘ç«¯ä¿å­˜</button>
        <button class="gbtn navbtn" id="btnReadJson">è¯»å–JSON</button>
        <button class="gbtn navbtn" id="btnSaveJson">ä¿å­˜JSON</button>

        <!-- çŠ¶æ€ç‚¹/æ–‡æ¡ˆï¼ˆå·²æ•´ä½“éšè—ï¼‰ -->
        <input type="file" id="jsonFilePicker" class="hide" accept=".json"/>
        <span class="dot" id="cloudDot"></span>
        <span id="cloudText" class="tiny">æœªè¿æ¥</span>
      </div>

      <!-- å³ï¼šä¸äº‘ç«¯æŒ‰é’®åŒå°ºå¯¸çš„å¯¼èˆªï¼ˆç¬¬äºŒæ’ï¼‰ -->
      <div class="leftgrp" id="tabs">
        <button class="gbtn navbtn active" data-page="home">ğŸ  é¦–é¡µ</button>
        <button class="gbtn navbtn" data-page="work">ğŸ’ª è®­ç»ƒ</button>
        <button class="gbtn navbtn" data-page="logs">ğŸ“˜ æ—¥å¿—</button>
        <button class="gbtn navbtn" data-page="settings">âš™ï¸ è®¾ç½®</button>
      </div>

    </div>
  </div>

  <!-- ========= é¡µé¢ï¼šé¦–é¡µ ========= -->
  <div id="page-home">
    <div class="card">
      <div class="row auto vm-notes">
        <div class="field">
          <div class="tiny">è¿›å…¥è®­ç»ƒé¡µæ–‡æ¡ˆ / è¯´æ˜</div>
        </div>
        <button class="gbtn" id="goWork">è¿›å…¥è®­ç»ƒé¡µ</button>
      </div>
    </div>
  </div>

  <!-- ========= é¡µé¢ï¼šè®­ç»ƒ ========= -->
  <div id="page-work" class="hide">
    <div class="card">
      <div id="vmRowTop">
        <div class="field"><input id="workTitle" placeholder="è®­ç»ƒæ ‡é¢˜"/></div>
        <div class="field"><select id="workPart"><option value="chest">èƒ¸</option><option value="back">èƒŒ</option></select></div>
        <div class="field"><input id="workUrl" placeholder="è§†é¢‘é“¾æ¥ / YouTube"/></div>
        <button class="gbtn btn ok" id="btnAddVideo">æ·»åŠ </button>
      </div>

      <div id="vmRowNotes" style="margin-top:12px">
        <div class="field notes"><textarea id="workNotes" placeholder="è®­ç»ƒæ³¨æ„äº‹é¡¹..."></textarea></div>
        <div class="field"><input id="refVideo" placeholder="å‚è€ƒè§†é¢‘URL"/></div>
        <div class="field"><input id="refTitle" placeholder="å‚è€ƒè§†é¢‘æ ‡é¢˜"/></div>
        <button class="gbtn btn ok" id="openVideo">æ‰“å¼€è§†é¢‘</button>
      </div>

      <div id="timerRow" style="margin-top:12px">
        <div class="field"><input type="number" id="countdown" placeholder="å€’è®¡æ—¶(ç§’)" min="0"/></div>
        <div class="field"><input type="number" id="rest" placeholder="ç»„é—´ä¼‘æ¯(ç§’)" min="0"/></div>
        <button class="gbtn btn ok" id="btnTimerSave">ä¿å­˜è®¡æ—¶è®¾ç½®</button>
      </div>

      <div id="brandRow" style="margin-top:12px">
        <div class="field"><input id="brandName" placeholder="å“ç‰Œæ–‡æ¡ˆ"/></div>
        <div class="field"><input id="brandColor" placeholder="#å“ç‰Œè‰²"/></div>
        <button class="gbtn btn ok" id="btnBrandSave">ä¿å­˜å¤–è§‚</button>
      </div>
    </div>
  </div>

  <!-- ========= é¡µé¢ï¼šæ—¥å¿— ========= -->
  <div id="page-logs" class="hide">
    <div class="card">
      <div class="row auto">
        <div class="field"><input id="logFilter" placeholder="ç­›é€‰å…³é”®å­—"/></div>
        <button class="gbtn btn ok" id="toggleAddLog">æ·»åŠ æ—¥å¿—</button>
      </div>
      <div id="addEditBox" class="hide" style="margin-top:12px">
        <div class="row auto">
          <div class="field"><input id="editTitle" placeholder="æ ‡é¢˜"/></div>
          <div class="field"><textarea id="editContent" placeholder="å†…å®¹"></textarea></div>
          <button class="gbtn btn ok" id="saveLog">ä¿å­˜</button>
          <button class="gbtn" id="cancelEdit">å–æ¶ˆ</button>
        </div>
      </div>
      <div id="logList" style="margin-top:12px"></div>
    </div>
  </div>

  <!-- ========= é¡µé¢ï¼šè®¾ç½® ========= -->
  <div id="page-settings" class="hide">
    <div class="card">
      <div class="row auto">
        <div class="field"><input id="cloudBase" placeholder="Cloudflare Worker Base URL"/></div>
        <button class="gbtn btn ok" id="btnVerify2">éªŒè¯ï¼ˆå†…éƒ¨ï¼‰</button>
      </div>

      <!-- ä½ çš„è§†é¢‘ç®¡ç†åŒºåŸŸ & å…¶ä»–è®¾ç½®ï¼Œç»“æ„å·²æŒ‰ä¸Šé¢ 2/3/4 ç‚¹ç»Ÿä¸€ -->
      <div id="vmRowTop" style="margin-top:12px">
        <div class="field"><input placeholder="è§†é¢‘æ ‡é¢˜"/></div>
        <div class="field"><select><option>èƒ¸</option><option>èƒŒ</option></select></div>
        <div class="field"><input placeholder="è§†é¢‘URL"/></div>
        <button class="gbtn btn ok">æ·»åŠ </button>
      </div>

      <div id="vmRowNotes" style="margin-top:12px">
        <div class="field notes"><textarea placeholder="æ³¨æ„äº‹é¡¹"></textarea></div>
        <div class="field"><input placeholder="å‚è€ƒURL"/></div>
        <div class="field"><input placeholder="å‚è€ƒæ ‡é¢˜"/></div>
        <button class="gbtn btn ok" id="openVideo2">æ‰“å¼€</button>
      </div>

      <div id="timerRow" style="margin-top:12px">
        <div class="field"><input placeholder="å€’è®¡æ—¶(ç§’)"/></div>
        <div class="field"><input placeholder="ä¼‘æ¯(ç§’)"/></div>
        <button class="gbtn btn ok">ä¿å­˜è®¡æ—¶è®¾ç½®</button>
      </div>

      <div id="brandRow" style="margin-top:12px">
        <div class="field"><input placeholder="å“ç‰Œæ–‡æ¡ˆ"/></div>
        <div class="field"><input placeholder="#å“ç‰Œè‰²"/></div>
        <button class="gbtn btn ok">ä¿å­˜å¤–è§‚</button>
      </div>
    </div>
  </div>

</div><!-- /.wrap -->

<!-- å¯é€‰ï¼šéŸ³é¢‘èµ„æº -->
<audio id="beepAudio" src="bell.mp3" preload="auto"></audio>

<script>
/* ========== é¡µé¢åˆ‡æ¢ ========== */
const $=id=>document.getElementById(id);
function showPage(name){
  ['home','work','logs','settings'].forEach(p=>{
    const el=$('page-'+p); if(!el) return;
    if(p===name) el.classList.remove('hide'); else el.classList.add('hide');
  });
  document.querySelectorAll('#tabs .navbtn').forEach(b=>{
    if(b.dataset.page===name) b.classList.add('active'); else b.classList.remove('active');
  });
}
document.querySelectorAll('#tabs .navbtn').forEach(b=>{
  b.addEventListener('click',()=>showPage(b.dataset.page));
});
$('goWork')?.addEventListener('click',()=>showPage('work'));

/* ========== åŒä¿é™©éšè—ï¼ˆé˜²æ­¢è¿è¡Œæ—¶è¢«åˆ«å¤„æ˜¾ç¤ºï¼‰ ========== */
function forceHideCloudLinkers(){
  ['btnVerify','btnPing'].forEach(id=>{
    const el=$(id);
    if(el){
      el.classList.add('hide-btn');
      el.style.display='none';
      el.setAttribute('aria-hidden','true');
    }
  });
}
document.addEventListener('DOMContentLoaded', forceHideCloudLinkers);
setTimeout(forceHideCloudLinkers, 50);
setTimeout(forceHideCloudLinkers, 500);

/* ========== è¿™é‡Œä¿æŒä½ çš„åŸæœ‰äº‘ç«¯/æ—¥å¿—/è®­ç»ƒé€»è¾‘é’©å­ï¼ˆç•™ç©ºå³å¯å¯¹é½æ ·å¼ï¼‰ ========== */
// ç¤ºä¾‹ï¼šJSON å¯¼å…¥/å¯¼å‡ºæŒ‰é’®å ä½
$('btnReadJson')?.addEventListener('click',()=>{ /* TODO: æ‰“å¼€æ–‡ä»¶é€‰æ‹©å™¨å¹¶è¯»å– */ });
$('btnSaveJson')?.addEventListener('click',()=>{ /* TODO: å¯¼å‡ºå½“å‰é…ç½®åˆ° JSON */ });

/* ========== ç§»åŠ¨ç«¯é¢å¤–ä¿®æ­£ï¼ˆå¯é€‰ï¼‰ç»Ÿä¸€æŒ‰é’®å­—ä½“/å†…è¾¹è· ==========
   é˜²æ­¢æŸäº›å®‰å“æµè§ˆå™¨æŠŠç¬¬äºŒæ’å­—ä½“æ¸²æŸ“ç¨å°å¯¼è‡´â€œçœ‹èµ·æ¥ä¸ç­‰é«˜â€ */
function fixMobileButtons(){
  const btns = document.querySelectorAll('.leftgrp .gbtn');
  const cs = { fontSize:'14px', padding:'0 16px', lineHeight:'40px', height:'40px' };
  btns.forEach(btn=>{
    btn.style.fontSize = cs.fontSize;
    btn.style.padding = cs.padding;
    btn.style.lineHeight = cs.lineHeight;
    btn.style.height = cs.height;
  });
}
document.addEventListener('DOMContentLoaded', fixMobileButtons);
window.addEventListener('resize', fixMobileButtons);
setTimeout(fixMobileButtons, 100);
setTimeout(fixMobileButtons, 500);

</script>
</body>
</html>
